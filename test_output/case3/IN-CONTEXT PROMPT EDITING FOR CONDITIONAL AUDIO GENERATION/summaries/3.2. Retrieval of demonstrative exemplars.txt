The section describes a retrieval pipeline that uses K-means clustering implemented with the Faiss library for scalable similarity search. Training prompts are projected into SBERT embeddings, and AudioCAPS and BBC Sounds prompts are used as exemplars for clustering. For each user prompt x_u, the system performs a similarity search against the indexed clusters to retrieve the top-M nearest training prompts x1, x2, ..., xM based on embedding-space distances. Using these neighboring exemplars, the in-context demonstration set C is built, with each x_i mapped to a corresponding c_i. The neighbors are ordered in nondecreasing distance so that d(c1) â‰¤ d(ci) for i > 1, creating a natural hierarchy of sentences within the cluster by contextual relevance to the user query. Consequently, the top-M candidate prompts are selected as illustrative examples, and the top candidate is structured as shown in Figure 2.