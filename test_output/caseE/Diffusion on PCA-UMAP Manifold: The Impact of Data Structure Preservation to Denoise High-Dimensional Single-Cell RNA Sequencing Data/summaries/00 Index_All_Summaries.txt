논문 제목: Diffusion on PCA-UMAP Manifold: The Impact of Data Structure Preservation to Denoise High-Dimensional Single-Cell RNA Sequencing Data
전체 섹션별 요약 인덱스
============================================================

섹션 1.: Introduction
----------------------------------------
Please provide the raw text of Section 1 of the paper. For Section 1 there is no prior summary to include. I will summarize Section 1 in a single paragraph, preserving all key numerical details while condensing the content. After you supply Section 1, I will generate the concise summary. If you have a preferred word limit or any focus areas, let me know.

섹션 2.1.: Preprocessing of the Row Count Single-Cell Matrix
----------------------------------------
We performed quality control prior to imputation (MAGIC or sc-PHENIX), including filtering out low-quality cells, discarding empty droplets in droplet-based technologies, and removing empty genes. We then applied library size normalization to obtain the scRNA-seq input for the imputation method. Preprocessing steps for each dataset are described in Sections 2.6 and 2.7. Normalization tailored to the technology reduces cell-size biases and ensures that the weighted neighborhood construction remains unbiased [5]. The sc-PHENIX input is the raw or preprocessed expression matrix (D) (Figure 1A). Lytal et al. suggest library size normalization is particularly well-suited for scRNA-seq data, but we provide flexibility for end users to choose the normalization method [26]. If users apply MAGIC, we recommend using the normalization approach described by Van Dijk et al. [5].

섹션 2.2.: PCA-UMAP Manifold and Creation of the Distance Cells Matrix
----------------------------------------
This section describes constructing the diffusion distance for sc-PHENIX by leveraging a PCA-UMAP manifold. Starting from the preprocessed count matrix D, PCA is used to initialize UMAP, producing the PCA-UMAP space matrix D_PCA-UMAP. Because UMAP embeddings can be interpreted as Euclidean projections, a Euclidean distance matrix D_Dist is computed in this PCA-UMAP space to drive diffusion and prevent oversmoothing. The key distinction from MAGIC is that sc-PHENIX uses the PCA-UMAP space rather than PCA alone to compute D_Dist, and users can employ alternative manifold initializations. PCA serves as a critical initialization that preserves global and local structure, yielding a meaningful low-dimensional representation for imputation. Caution is given against very low-dimensional UMAP (2D or 3D), as these may not preserve high-dimensional distances; this is supported in Section 3.2, where imputing high-dimensional bulk data with 80% artificial zeros using more than n_components = 3 (UMAP dimensions) yields higher R^2 between imputed and original data. UMAP’s embedding dimension can be three components or more, aligned with the underlying scRNA-seq data manifold to enhance clustering and downstream analyses. Figure 1A and 1B depict the workflow used to compute the matrices for imputation.

섹션 2.3.: Creation of the Affinity Matrix
----------------------------------------
sc-PHENIX builds the affinity matrix with an adaptive Gaussian kernel, following MAGIC's approach for imputation stability. The kernel bandwidth σ(i) for cell i is defined as the distance to its k-th nearest neighbor (knn), allowing the measure to adapt to local cell density. Applying this adaptive kernel to the distance matrix D_Dist yields a non-symmetric affinity matrix A_non-sim, where A_non-sim(i, j) need not equal A_non-sim(j, i). A symmetric affinity matrix A_sim is then obtained as required by Equation (3).

섹션 2.4.: Row-Stochastic Markov-Normalization of A into Markov Matrix M
----------------------------------------
To obtain the Markov transition matrix M, A_sim is row-normalized so that every row sums to one, yielding the probability distribution of transitions from a given cell to all others in the scRNA-seq data. This normalization is performed by dividing each entry in A_sim by the sum of the affinities in its row, i.e., the row sum, as defined in Equation (4).

섹션 2.5.: Data Diffusion and Imputation
----------------------------------------
After M is computed by row-normalization, diffusion proceeds by exponentiating M to M^t, with t defined as the diffusion time; M^t(i,j) is the probability that a random walk of length t from cell i will reach cell j. This diffusion strengthens weights among phenotypically similar cells and down-weights spurious neighbors, filtering out noise such as dropouts, artifacts, and uneven transcript capture that lack structure on the manifold; as t grows, diffusion better recovers the manifold and removes noisy dimensions. Imputation is then performed by the matrix product M^t and D (Eq. 5). The study finds that a PCA-based initialization for M^t fails to separate distinct phenotypes adequately, causing over-smoothing and limiting information sharing to only a few local neighbors, which undermines biological insights and yields poorly structured gene-gene interactions as observed with MAGIC, especially at lower t. In contrast, a PCA-UMAP initialization (sc-PHENIX) effectively separates phenotypes, enabling more comprehensive cell-graph imputation and allowing information sharing in a more local setting with higher values of t, knn, or PCA dimensions; this approach reduces over-smoothing and uncovers local details of cell types that non-imputation methods and MAGIC miss.

섹션 2.6.: Worm Bulk Microarray Data Processing
----------------------------------------
To assess the imputation accuracy of MAGIC and sc-PHENIX, the authors built a validation dataset from bulk transcriptomic data of 206 synchronized C. elegans young adults, measured at regular intervals over a 12-hour developmental period using microarrays. They modified the approach by randomly and uniformly inserting zeros, exponentiated the log-scaled expression levels matrix, and downsampled each entry to retain 80% of the original data. The introduction of zeros causes samples to cluster more, complicating the computation of similarities and thus challenging both imputation methods. They chose to use this corrupted count matrix after exponentiation because the matrix prior to zero insertion preserves developmental time order and the continuum structure. Regarding dropout, although in scRNA-seq dropout occurs randomly with any transcript having an equal chance of being missed and is more likely for low expression, even highly expressed genes may not be detected in all cells; the authors expect the remaining data to still contain sufficient information to accurately compute similarities for imputation.

섹션 2.7.1.: Peripheral Blood Mononuclear Cells Dataset
----------------------------------------
This section describes a dataset of 3,000 peripheral blood mononuclear cells (PBMCs) from a healthy donor, with RNA content of about 1 pg per cell, of which 2,700 cells were detected. The data come from the 10x Genomics pbmc3k resource (accessed via the specified URL). Preprocessing follows the Seurat tutorial: quality control, normalization by library size, and a Log +1 transformation. Additionally, data were imputed using SAVER with default parameters, and for knn-smoothing, the authors varied the PCA and knn values based on the preprocessed matrix.

섹션 2.7.2.: Neuronal Dataset
----------------------------------------
This Nature Neuroscience dataset delineates a cellular taxonomy of the adult mouse primary visual cortex using single-cell RNA sequencing, identifying 49 transcriptomic cell types comprising 23 GABAergic, 19 glutamatergic, and 7 non-neuronal types, across 24,057 genes and 1,679 cells. Source: https://singlecell.broadinstitute.org/single_cell/study/SCP6/a-transcriptomic-taxonomy-of-adult-mouse-visual-cortex-visp#study-download (accessed 4 June 2024). Preprocessing used RPKM normalization, with imputation parameters varied according to combinations of t, knn, and PCA dimensions; MAGIC parameters were default. For sc-PHENIX, UMAP parameters were n_components = 5, n_neighbors = 14, verbose = True, metric = 'cosine', min_dist = 0.2, n_epochs = 1000, negative_sample_rate = 5. To visualize the imputed data, a 2D-UMAP was created from the non-imputed data to observe imputed-cell behavior, with non-imputed data 2D-UMAP parameters: n_components = 2, n_neighbors = 10, verbose = True, metric = 'cosine', min_dist = 0.5, n_epochs = 1500, negative_sample_rate = 5, set_op_mix_ratio = 0.8, learning_rate = 0.1, local_connectivity = 3, random_state = 42; input was the RPKM-normalized data. Imputation was then performed on this dataset using knn-smoothing parameters based on varying PCA and knn values.

섹션 2.7.3.: Epithelium Mesenchyme Transition Dataset
----------------------------------------
The EMT dataset comprises single-cell RNA sequencing data generated with the inDrop method from the HMLE breast cancer cell line undergoing epithelial–mesenchymal transition, capturing 7,523 cells and 28,910 genes at 8 and 10 days after TGF-β stimulation. The data were derived from the original MAGIC publication and are used here to evaluate the reproducibility of sc-PHENIX compared to MAGIC when sc-PHENIX is initialized with PCA. Source data include the GitHub MAGIC dataset HMLE_TGFb_day_8_10.csv.gz and GEO accession GSE114397. Preprocessing followed the MAGIC article using the scprep library, with library-size normalization and filtering via scprep.normalize.library_size_normalize() and scprep.filter.filter_library_size(cutoff = 1500). Scprep is a Python framework for loading, preprocessing, and visualizing single-cell data. Imputation parameters were t = 6, knn = 30, decay = 15, and the first 20 PCA dimensions.

섹션 2.7.4.: Tumor Spheroid Dataset
----------------------------------------
The tumor spheroid dataset comprises 364 cells and 23,922 genes, with raw data and the count matrix available through GEO accession GSE145633; the data correspond to the same resource used in the sc-PHENIX evaluation and were accessed on 4 June 2024. A limitation of MAGIC is that it can yield a low-dimensional manifold for initialization when pre-filtering by most variable genes, potentially excluding significant genes during imputation; for example, filtering at the 85th percentile may remove the VIM marker and many transcription factors and membrane receptors due to low abundance, since genuine biological differences are assumed to manifest as increased variation among these genes. Opportunity exists in sc-PHENIX to recover all genes while creating a PCA-UMAP initialization from the most variable genes, enabling interrogation of gene–gene interactions and dropout and filtration effects that masking with most-variable-gene filtering would otherwise obscure; in MAGIC van Dijk et al. used all genes to recover EMT data, providing a basis for comparing these approaches. For MAGIC imputation, the initial count matrix (23,922 genes) was library-size normalized with scprep, square-root transformed, then imputed with t = 5 and knn = 20, using 100 PCA dimensions from the preprocessed matrix. In contrast, sc-PHENIX starts from a library-size-normalized count matrix that is square-root transformed; for PCA–UMAP initialization, the data are filtered to the top variable genes via scprep.select.highly_variable_genes(data_sqrt, percentile = 85), reduced to 30 PCA components and 30 UMAP components, with UMAP configured as n_components = 30, metric = 'euclidean', n_epochs = 1000, min_dist = 0.5, verbose = 1, random_state = 1; imputation uses t = 5, decay = 5, and knn = 20. Phenotype characterization focused on MCF7 clusters: after preprocessing, imputation results from MAGIC and sc-PHENIX were compared across all genes; extreme phenotypes were explored by embedding the imputed data in a 3D PCA space, followed by archetypal analysis to identify extremal points that are convex combinations of observations. In this 3D space, HDBSCAN was applied to the PCA projections to locate dense clusters near archetypes, labeling noise as -1, thereby facilitating visualization of cellular states at the manifold’s edges. Differences in gene expression across clusters for the imputed data were quantified with Earth Mover’s Distance (EMD) for differential expression by clusters (one-vs-all, i.e., first Wasserstein distance), with the EMD score defined as EMD × sign(mean difference) to indicate direction, computed using scprep. For downstream interpretation, WebGestalt was used to perform gene set enrichment analysis on the EMD-derived scores, restricting to MSigDB Hallmark gene sets (h.all.v7.5.1.symbols.gmt) and REACTOME (c2.cp.reactome.v2022.1.Hs.symbols.gmt), and setting significance at FDR < 0.05 with p = 0; enrichment results were reported with their NES values. Using EMD instead of means avoids biases from multimodal distributions in scRNA-seq, enabling more robust GSEA conclusions.

섹션 2.8.: Multidimensional Scaling of Exponentiated Transition Markov Matrix
----------------------------------------
This section describes how the PCA space and the exponentiated transition matrix Mt (from PCA and PCA–UMAP initialization) are transformed into a distance matrix D_dist to enable multidimensional scaling (MDS; see Fig. 1C). To minimize stress efficiently and preserve high-dimensional distances in the low-dimensional manifold, the authors employ the stochastic gradient descent (SGD) algorithm from a referenced approach, which can project data from a distance matrix into 2D or 3D spaces and has been shown to achieve lower stress more quickly than majorization without relying on a good initialization. Since MAGIC provides only the imputed matrix and not Mt, Mt for MAGIC is inferred indirectly by computing Mt via sc-PHENIX with PCA initialization (details in Supplementary Material S1). For the neuronal dataset, several 2D plots are generated from the Mt of MAGIC and sc-PHENIX under various combinations of PCA dimensions, t, and knn values to evaluate cluster structure preservation. A KNeighborsClassifier with knn = 30 from scikit-learn is used to assess local structure by predicting 21 phenotype labels from the 2D embeddings, thereby quantifying how well the 2D projections retain the underlying cluster structure.

섹션 2.9.: PHATE Visualization
----------------------------------------
To evaluate their visualization method, the authors compared it with PHATE (Potential of Heat Diffusion for Affinity-based Transition Embedding). PHATE is designed to preserve local, global, and continuum structures in low-dimensional embeddings using a unique informational distance metric, and it incorporates PCA preprocessing to enhance robustness and reliability. They applied PHATE to the MNIST dataset (knn = 5, n_pca = 500, n_components = 2) and to the Neuronal dataset (knn = 30, n_pca = 500, with n_components = 3 and 2) as benchmarks.

섹션 2.10.: Imputation Performance of Neuronal Cells
----------------------------------------
We evaluated MAGIC and sc-PHENIX across multiple diffusion parameters and PCA dimensions on the adult mouse visual cortex neuronal dataset from Tasic et al., which comprises 21 well-characterized cell phenotypes and was selected because prior work showed MAGIC can group several phenotypes, making imputation evaluation challenging. A post hoc Tukey’s test was used to compare means while controlling the family-wise error rate with FWRD = 0.05, implemented via pairwise_tukeyhsd from statsmodels. Differential expression for imputed markers was computed with Tukey’s HSD at FWRD = 0.05, evaluating Flt1 (NonNeu_Endo and NonNeu_SMC), Chat (GABA_Vip), Sst (GABA_Sst), and Serpin11 (Gluta_L6B) from imputed data; these markers were determined from Tasic et al. to gauge imputation quality. A confusion matrix was created for each imputation from MAGIC and sc-PHENIX using various parameter combinations, recording whether each marker was differentially expressed (1) or not (0), and from these matrices precision, recall, and f1-score were derived—the higher these metrics, the better the imputation preserves gene expression across phenotypes. The authors note that over-smoothing evaluations are relevant for scRNA-seq imputation benchmarking, though not a quality-control metric, and Supplementary Material: Methods S1 provides a visual diagram of imputation performance.

섹션 3.1.: Results Overview
----------------------------------------
The results are organized into four subsections that compare sc-PHENIX with MAGIC across multiple facets. In Section 3.2, Performance of Diffusion-Based Imputation, the authors assess how PCA and PCA-UMAP initialization influence imputation using bulk transcriptomic data, sweeping parameter settings such as t, knn, and PCA dimensions to evaluate performance. In Section 3.3, Visualization with sc-PHENIX, they provide visualizations illustrating that sc-PHENIX minimizes over-smoothing relative to MAGIC, using datasets including MNIST and neuronal data, and also presenting PBMC analyses to illustrate effects on gene–gene interactions. In Section 3.4, Evaluation of Over-Smoothing, they analyze marker integrity across neuronal phenotypes to compare how well each method preserves marker signals without excessive smoothing. Finally, Section 3.5, Evaluation of the Heterogeneity of MCF7 Cells Data, examines spheroid heterogeneity, discusses differences in 3D PCA manifolds and dense clusters, and notes that sc-PHENIX captures more transition states and extreme phenotypes than MAGIC.

섹션 3.2.: Performance of Diffusion-Based Imputation Using Bulk Data: Evaluating the Effects of PCA and PCA-UMAP Initialization
----------------------------------------
This section investigates how PCA initialization (as in MAGIC) versus PCA-UMAP initialization (as proposed here) affects diffusion-based imputation performance on bulk data, using 206 developmentally synchronized C. elegans samples with 80% random zeros introduced to simulate dropout, spanning a 12-hour developmental trajectory measured by microarrays. We compare two PCA-based neighbor settings, knn = 30 (high) and knn = 5 (low), fixing t = 5 and decay = 15 for the high/low comparisons in Figures 2A, 2B, and 2C. In Figure 2A (high knn), 2B (mixed knn: MAGIC knn = 5, sc-PHENIX knn = 30), and 2C (low knn), sc-PHENIX consistently outperforms MAGIC in terms of Pearson, Spearman, and R2 across the number of PCA components, with the orange vs blue curves and 95% CIs indicating robustness; specifically, the Pearson AUC values are 0.76 for sc-PHENIX versus 0.68 for MAGIC in 2A, 0.76 versus 0.72 in 2B, and 0.71 versus 0.72 in 2C. However, in the low knn regime, MAGIC initially outperforms sc-PHENIX at small numbers of PCA components (roughly >10 but <25), while sc-PHENIX starts lower when fewer than ~100 PCA components are used but improves with more PCs, rarely surpassing MAGIC at very low dimensionality. Overall, the AUC analysis shows little difference between methods in the low-knn scenario, suggesting comparable robustness to PCA dimensionality, whereas MAGIC benefits from low PCA dimensionality and low knn, while sc-PHENIX gains with higher PCA dimensionality and higher knn, generally outperforming MAGIC as dimensionality grows.

We further evaluated PCA-UMAP initialization by fixing t = 5, decay = 5, n_pca = 71, and knn = 30. In this setup, PCA-UMAP initialization yields better performance for sc-PHENIX than UMAP alone across all three metrics, and increasing the number of UMAP dimensions improves robustness, with at least three dimensions sustaining performance in this small, topologically simple dataset. Figure 2H shows that 71 PCA components capture about 70% of the dropout data variance (as indicated in Figure 2J), guiding the choice of n_pca = 71 to align with MAGIC’s recommendation. Under this regime, MAGIC’s performance worsens with more than 71 PCA components due to over-smoothing, whereas PCA-UMAP for sc-PHENIX mitigates this risk, highlighting sc-PHENIX’s robustness to PCA dimensionality when paired with PCA-UMAP initialization.

The analysis emphasizes that sc-PHENIX’s performance is robust to PCA dimensionality and benefits from higher knn, enabling broad-imputation improvements over MAGIC across most settings. At the gene level, local knn-based localization of expression with sc-PHENIX preserves low or zero values and avoids the over-smoothing observed with MAGIC, as illustrated for three genes (C27A7.6, dct-5, erd-2) in the 2D UMAP plots and accompanying trend visualizations. When examining developmental-time trajectories with varying knn, sc-PHENIX preserves the overall trend while MAGIC increasingly blurs distinctions with higher knn due to diffusion-like smoothing. Although sc-PHENIX can lose some sensitivity to very low expression when knn is very high, it generally maintains clearer groupings and transitions than MAGIC. The study also compared initialization strategies beyond PCA-UMAP, including PCA-tSNE, full t-SNE, and Laplacian Eigenmaps-UMAP; none outperformed PCA-UMAP or UMAP-based initialization, with t-SNE constrained to three dimensions and occasionally underperforming relative to UMAP-based approaches. Finally, varying the decay parameter produced a modest AUC improvement (~0.01) when explored alongside higher PCA dimensionality, reinforcing that the best practical pairing is a low knn for MAGIC and a high knn for sc-PHENIX, with clearer separation between methods demonstrated in the extended Figure 3.

섹션 3.3.: Visualization with sc-PHENIX
----------------------------------------
Section 3.3 Visualisation with sc-PHENIX demonstrates that sc-PHENIX reduces over-smoothing relative to MAGIC by examining the cell neighborhoods defined by the exponentiated Markov matrix M^t and by visualizing imputed data in terms of gene–gene interactions. The section also notes that the implementation details of sc-PHENIX are organized into subsections.

섹션 3.3.1.: Visualization of the Exponentiated Markov Matrix Based on Different Manifold Initializations
----------------------------------------
Section 3.3.1 investigates how the exponentiated Markov matrix M^t, the diffusion step underlying methods like MAGIC and sc-PHENIX, represents data structure when initialized on different manifolds (PCA versus PCA–UMAP). Exponentiating the transition matrix yields a low-pass filter that boosts affinities among similar samples while down-weighting spurious neighbors, and defines a diffusion graph over random walks of any length t that has been used for imputation on PCA space; however, MAGIC preprocessing can distort the low-dimensional manifold by merging distinct cell types, so the authors evaluate diffusion-induced distortion by visualizing M^t with multidimensional scaling (MDS) projections, distinguishing PCA M^t (PCAM^t) from PCA–UMAP M^t (PCA–UMAP M^t). They compare two datasets: MNIST, chosen for its clear cluster structure in low-D space, and the adult mouse visual cortex neuronal dataset (Tasic et al.), used to assess preservation of local structure and to illustrate MAGIC-induced phenotypic grouping and how sc-PHENIX mitigates it. The analysis presents several visualization panels, including a three-dimensional MDS plot of M^t with 500 PCs mapped into 60 UMAP components (knn = 50, t = 10), a two-dimensional MDS plot for MAGIC (500 PCs input, knn = 30, t = 5), and a two-dimensional MDS plot for sc-PHENIX (500 PCs transformed into 60 UMAP components, knn = 50, t = 10), along with images illustrating MNIST digits to reflect continuum and branch structure. The findings show that for MNIST, PCA–UMAP M^t better captures local and continuum structure, whereas PCA M^t preserves global structure more effectively; for the scRNA-seq data, PCA M^t preserves some global structure but poorly preserves local structure due to mixing neighboring regions of different cluster densities, while PCA–UMAP M^t improves local and continuum representation. In the neuronal dataset, local structure distortion is evident in PCA M^t because GABAergic and glutamatergic phenotypes cluster together and non-neuronal phenotypes can lie near neuronal ones; this MAGIC-induced distortion is mitigated by PCA–UMAP M^t, which yields clearer separation of the main neuronal clusters and better preservation of local structure. Globally, MNIST shows comparable global structure across PCA space and M^t representations, while in the neuronal data the PCA–UMAP M^t embedding better preserves global structure by separating non-neuronal clusters from neuronal phenotypes. Finally, continuum structure is visually evaluated for MNIST, revealing density-driven continuation along the manifold, whereas continuum was not assessed for the neuronal dataset due to unconnected phenotypes and limited samples, a condition requiring pseudotime methods and making it difficult to evaluate t, knn, and PCA combinations for MAGIC and sc-PHENIX solely in local/global terms.

섹션 3.3.2.: Evaluation of Continuum Structure Preservation after MAGIC and sc-PHENIX on Gene-Gene Interaction Visualizations
----------------------------------------
Section 3.3.2 evaluates how MAGIC and sc-PHENIX preserve continuum structure by examining imputed gene–gene interactions in the 10x human PBMC scRNA-seq dataset, which includes nine characterized immune phenotypes and an analysis of the naive-to-memory CD4+ T transition marked by CCR7 and IL7R. The study found that MAGIC distorts CCR7 downregulation through over-smoothing across distinct phenotypes, compromising the continuum, whereas sc-PHENIX with PCA–UMAP initialization largely preserves CCR7 downregulation across most parameter combinations, supporting better continuum recovery. To quantify structure, they used 2D MDS plots of the diffusion-transformed matrix M_t and, for robustness, analyzed the neuronal dataset via a KNN classifier to measure local-structure preservation across parameter settings, with supplementary visual analyses in Sections S3–S5. Supplementary S5 shows that, for MAGIC in PCA space, three main neuronal clusters—GABAergic, glutamatergic, and non-neuronal—overlap under various diffusion parameter configurations, and increasing knn, t, or the number of PCA dimensions degrades local structure, consistent with diffusion-induced distortion described by Mukherjee et al. Conversely, PCA–UMAP M_t plots for sc-PHENIX exhibit diminished distortion and clearer separation, especially between GABAergic and glutamatergic clusters, indicating preserved local structure. To compare methods, they evaluated 250 parameter combinations (125 per method) using KNN accuracy across 2D MDS embeddings, with results summarized in Figure 6: sc-PHENIX consistently yields higher accuracy than MAGIC across most configurations, attaining its best performance with higher PCA dimensions (100, 200, 500) and moderate-to-high knn values as t increases, highlighting superior local-structure preservation under these conditions; MAGIC performs worse, with accuracy dropping at low knn and high PCA dimensions and no consistent gains from increasing t, given its default t = 3. Overall, the findings indicate that sc-PHENIX is more robust than MAGIC in preserving local structure and achieving higher accuracy across parameter spaces, with the best results for sc-PHENIX at larger PCA dimensions and higher knn, underscoring the importance of parameter choice in optimizing imputation for scRNA-seq data; embedding details for each parameter set are provided in Supplementary Materials S5.

섹션 3.3.4.: Distribution of Distinct Cluster Samples on Dense Regions of M t
----------------------------------------
This section extends beyond the MDS view by directly probing the density structure of the M_t embeddings using MNIST as a test manifold. The authors apply HDBSCAN to the distance matrices derived from PCA space and from PCA-derived PCA-UMAP space, with M_t constructed in both PCA space and PCA-UMAP space, to identify dense regions and assess whether observed agglomerations reflect true structure or distorting artifacts. They argue that the spurious clustering seen in multidimensional PCA (and in MAGIC’s M_t) arises from distance concentration or distortion of the data, and that a density-based criterion can reveal the real manifold structure.

Results in PCA space show only one dense cluster corresponding to the digit “1”; nearly all other MNIST samples are labeled as noise, aligning with the visual density seen in prior figures. In diffusion on PCA space, a single dense cluster (Cluster A) contains almost all samples, with a minority deemed noise. By contrast, diffusion on PCA-UMAP space yields seven distinct density clusters (A–G), indicating clearer separation of diverse digits. This non-visual evidence suggests that the M_t computed for sc-PHENIX with PCA-UMAP initialization can better disentangle true dense clusters and reflect underlying manifold structure. The authors also note that the accompanying non-visual analysis of MAGIC’s M_t (Figure 4) shows multiple distinct phenotypes being grouped erroneously due to inadequate PCA initialization, rather than the MDS approach itself. Overall, density-based clustering via HDBSCAN corroborates that PCA-UMAP–initialized M_t captures more faithful structure and mitigates spurious agglomeration.

섹션 3.3.5.: Comparing the Visual Results of PHENIX (PCA-UMAP) Versus Specialized Visualization Methods
----------------------------------------
The authors compare the preservation of local, global, and continuum structure between their visualization approach—MDS plots of the M t derived from diffusion on the PCA-UMAP space of sc-PHENIX—and specialized methods PHATE and UMAP. In PHATE plots of the neuronal dataset and of MNIST, local structure is compromised, with neuronal phenotypes overlapping and, on MNIST, samples of different digits intermingling in dense regions, indicating loss of locality despite some global organization. On MNIST, PHATE retains more global structure than MAGIC and separates digits better than MAGIC, but it does not outperform sc-PHENIX because local continuity is still impaired: extreme regions show 1s connected to 7s and 2s, reflecting disrupted gradual transitions. PHATE also preserves global proximity, placing digits like 7, 4, and 9 near each other and grouping 3, 5, and 8 together, but this comes at the cost of local fidelity. UMAP, shown in supplementary figures, merges digits 4, 7, and 9 into a single large cluster, obscuring substructure and highlighting UMAP’s inadequacy for sustaining continuum structure in 2D. By contrast, sc-PHENIX preserves continuum structure more faithfully while maintaining local distinctions, evidenced by distinct inner branches for each digit in supplementary material. Overall, PHENIX’s PCA-UMAP visualization captures continuity better than MAGIC, but PHATE and UMAP exhibit limitations relative to the preservation of both local and continuum structure achieved by sc-PHENIX.

섹션 3.3.6.: The inherent Risk of Diffusion Artifacts
----------------------------------------
This section argues that diffusion artifacts arise when the manifold initialization is poorly suited, such as PCA space, which creates spurious connections between densities of distinct clusters due to a small density gap in PCA space, as seen in the poor separation reported in Figures 4D and 5A and Supplementary Material S5. It shows that PCA alone does not separate densities well enough to prevent diffusion-induced connections (Figure 4A), with sparsity driving the near-neighbor densities of different clusters closer together (Supplementary Material S6). Moreover, diffusion approaches based on PCA (PHATE) distort the manifold when data have high missingness, whereas PCA-UMAP is more suitable for separating distinct clusters in sparse data (S6). As a result, PCA-UMAP initialization solves the major issue for accurately constructing M_t using only PCA initialization, which matters because sc-PHENIX and MAGIC require the manifold embedded in M_t for the final imputation step (Figure 1B, matrix multiplication). To avoid over-smoothing from sharing information among spurious nearest neighbors, M_t must capture the data’s local, global, and continuum structure as fully as possible. Consequently, the authors recommend sc-PHENIX using PCA-UMAP (Figure 4D) space rather than PCA alone to address the major issues caused by MAGIC’s diffusion on PCA space (Figure 4C). Finally, preserving data structures in diffusion methods is crucial for detecting and handling rare phenotypes among ubiquitous cells in transcriptomic space; rare phenotypes reside in low-density regions due to rapid phenotype transitions and are transient, as noted with reference [48].

섹션 3.4.: Evaluation of Over-Smoothing among Distinct Cell Phenotypes
----------------------------------------
This section evaluates over-smoothing using the adult mouse visual cortex dataset, which has three main cell phenotypes (GABAergic, glutamatergic, non-neuronal) and 21 sub-phenotypes, with known differential markers to test whether imputation preserves marker distinctions. The authors compare MAGIC and sc-PHENIX across multiple parameter combinations (t, knn, and the number of PCA dimensions) to avoid biased conclusions based on default settings. They focus on markers Flt1 (endothelial/smooth muscle), Vip and Chat (Vip cells), Sst (Sst cells), and Serpinb11 (Gluta_L6b). In Figure 8A–C, both methods’ recovery of Flt1 is shown on the UMAP, revealing that increasing knn, t, and PCA dimensions worsens over-smoothing with MAGIC, while sc-PHENIX maintains marker expression within their respective clusters; similar results hold for Vip, Sst, and Chat (supplementary Fig. S11). To quantify performance, they compute precision, recall, and F1 using Flt1 for NonNeu_Endo/NonNeu_SMC, Sst for GABA_Sst, Chat for GABA_Vip, and Serpin11 for Gluta_L6B, with a differential expression criterion of Fold Change = 2.0 and FWRD = 0.05 via Tukey’s HSD. They report that MAGIC’s performance deteriorates as parameters and PCA dimensions increase, whereas sc-PHENIX does not sacrifice performance and avoids oversmoothing, consistently better preserving marker separation as shown in M_t MDS plots and Figure 5D’s PCA-UMAP initialization. In contrast, MAGIC with PCA initialization fails to provide good imputation across any parameter combination, over-smoothing all markers even with conservative (low knn and t) settings, aligning with artifacts reported in prior work. The results are supported by precision, recall, and F1 trends across parameter grids, with explicit notes on how adjusting knn, t, and n_pca (e.g., knn = 15 and t = 15 to boost PCA effects; knn = 15 with n_pca = 30 to raise t; or knn = 15 and PCA = 30 to raise knn) influences the reported metrics. Overall, the section demonstrates that sc-PHENIX, using PCA-UMAP initialization, better preserves cell-phenotype–specific marker expression and avoids over-smoothing compared with MAGIC across diverse diffusion parameter regimes.

섹션 3.5.: Evaluation of the Heterogeneity of Spheroids of MCF7 Cells Data with Imputation
----------------------------------------
This section assesses imputation on the 3D Multicellular Cancer Tumor Spheroids of the breast cancer cell line MCF7 (MCF7 MCTS) scRNA-seq data across two growth timepoints (days 6 and 19) to compare MAGIC and sc-PHENIX. The authors impute and evaluate recovered biological insights by reporting precision, recall, and F1 for imputation across different combinations of knn, t, and PCA dimensions, using Flt1 for NonNeu_Endo/NonNeu_SMC, Chat for GABA_Vip, Sst for GABA_Sst, and Serpin11 for Gluta_L6B, with differential expression thresholds Fold Change = 2.0 and FWRD = 0.05 via Tukey’s HSD. To modulate PCA influence they note that knn = 15 and t = 15 increase PCA effects; knn = 15 with n_pca = 30 increases t; and knn = 15 with PCA = 30 increases knn, referencing prior figures. In parallel, they impute the MCF7 MCTS data to reevaluate biological insights and perform a Gene Set Enrichment Analysis, identifying three subpopulations without imputation: invasive, proliferative, and reservoir. The invasive phenotype exhibits immune-adaptive characteristics, the proliferative phenotype drives growth, and the reservoir may be a transitional phenotype sharing proliferation and invasion pathways.

섹션 3.5.1.: Differences in 3D PCA Manifold of Imputed Data
----------------------------------------
In this subsection, to identify and characterize the extreme phenotypic states and transition phenotypes in a better-formed structure, the authors compare 3D-PCA plots of imputed data with MAGIC (Figure 10A) and sc-PHENIX (Figure 10B); interactive 3D-PCA plots for MAGIC and sc-PHENIX are provided in Supplementary Material Figures S12 and S13, respectively. They detect and compare dense clusters via HDBSCAN in each 3D-PCA space, finding five dense clusters with MAGIC and ten dense clusters with sc-PHENIX. Downstream analysis includes differential expression by cluster using an EMD score heatmap, a GSEA heatmap with FDR < 0.05 and NES values considered only if positive, and visualization restricted to dense clusters in the imputed 3D-PCA space. The dense clusters under sc-PHENIX are visually more separated than under MAGIC, which yields fewer dense clusters due to cell-grouping; thus near-cluster proximity is interpreted as similar phenotypes, whereas larger distances after sc-PHENIX indicate distinct phenotypes. Sc-PHENIX displays more branches, with four well-defined branches in Figure 10B that could reflect intricate transition states among phenotypes, whereas MAGIC shows no clear trajectory and only a simple trajectory along PC1 and PC2. Regarding extreme phenotypes under sc-PHENIX, the 3D-PCA plot reveals four extremes corresponding to clusters 2, 4, 5, and 7; however, along PC3 these clusters lie in a narrow range, while PC1/PC2 suggest that clusters 0, 2, and 4 could be extreme phenotypes (see Supplementary Figure S12). The authors then proceed to biologically characterize all dense clusters to confirm the biology, focusing on extreme phenotypes and potential intermediate states.

섹션 3.5.2.: Over-Smoothing Analysis of Imputed Data and Continuum Structure Implications
----------------------------------------
Building on the observation that MAGIC yields denser, more tightly grouped clusters than sc-PHENIX, the authors use DEG-based EMD heatmaps to compare gene expression shifts among dense clusters under the two imputation methods. MAGIC shows mitochondrial (MT) gene over-expression in 4 of 5 dense clusters (clusters 0–3), whereas sc-PHENIX restricts MT over-expression to clusters 0–2 (3 of 10 dense clusters). To rule out sample-size effects causing over-smoothing under MAGIC, they split the data into eleven k-means clusters and obtained the same over-smoothing pattern as in Figure 10A, confirming that MT over-smoothing is indeed a MAGIC artifact; under sc-PHENIX, MT over-expression is not similarly pervasive. VEGFA over-expression is mainly in cluster 2 with sc-PHENIX, while MAGIC shows VEGFA over-expression in cluster 4; in the necrotic context, MT genes and VEGFA mark dying cells with lower UMI counts, with cluster 3 most representative of necrosis due to MT and VEGFA over-expression. Diffusion-imputation reveals data continuity and continuum structure, and the two methods diverge in trajectory topology: sc-PHENIX reveals four branches (4→2, 4→7, 7→5, 3→2) to extreme clusters, whereas MAGIC presents only one branch (0→1→2→3→4) because of over-smoothing. In VIM-CDH-FN1 interactions, extreme cluster 4 suggests a mesenchymal state with CDH1 down-regulation and VIM up-regulation under sc-PHENIX, whereas MAGIC implies proportional increases in VIM and CDH1, a biologically inconsistent pattern likely due to over-smoothing. Across extremely dense clusters, sc-PHENIX shows more diverse differential expression and transition states, with cluster 3 sharing multiple enriched pathways with the invasive cluster 5 and exhibiting the highest HIPOXIA NES value of 3.7935, indicating a transition 3→1→2 toward necrosis; the COAGULATION HALLMARK is enriched in cluster 3 only with sc-PHENIX, aligning with angiogenesis-related invasion in metastatic breast cancer. For extreme clusters 7 and 8, proliferative and invasive hallmarks are present, including OXIDATIVE_PHOSPHORYLATION, ESTROGEN_RESPONSE_LATE, MTORC1_SIGNALING for proliferation, and TNFA_SIGNALING_VIA_NFKB, REACTIVE_OXYGEN_SPECIES_PATHWAY for invasion, while CHOLESTEROL_HOMEOSTASIS uniquely characterizes 7 and 8. Reactome analyses of transition clusters 7 and 8 reveal high NES for REACTOME_CELLULAR_RESPONSE_TO_STARVATION and REACTOME_MITOPHAGY, with mitophagy absent from proliferative/invasive extremes, suggesting a tumor microenvironment where nutrient gradients and energetic stress shape phenotypes. The authors conclude that sc-PHENIX yields richer, more nuanced biological insights than MAGIC or non-imputed data, demonstrating higher resolution and reduced over-smoothing; they also note that these finer insights will be expanded in future work leveraging sc-PHENIX imputation.

섹션 4.: Discussion
----------------------------------------
Imputation of scRNA-seq data is essential but inherently prone to over-smoothing, so the authors introduce sc-PHENIX as an enhancement of MAGIC that leverages PCA-UMAP initialization and diffusion maps to better preserve local, global, and continuum structures. They show, across three biological systems and additional non-biological data, that sc-PHENIX maintains global and local organization and a continuum of cell states (as evidenced by the reported continuum structure in the cited figures), whereas MAGIC increasingly distorts structure when knn, t, or PCA dimensions rise. In the MCF7 MCTS dataset, sc-PHENIX reveals hidden heterogeneity and distinct trajectories, including extreme archetypes such as starving (cluster 7) and necrotic (cluster 2), with 3D PCA providing a clearer depiction of these trajectories and extreme phenotypes than t-SNE, UMAP, or PHATE on MAGIC-imputed data, supporting a continuum view of cancer cell states.

Three guiding diffusion-imputation factors are outlined: effectively separating distinct phenotypic densities (local structure), arranging them coherently on the manifold (global structure), and linking them through a valid continuum (continuum structure). PCA-UMAP initialization enables more extensive sharing of information across local neighbors without oversmoothing, allowing higher values of diffusion parameters (t, knn, PCA dimensions) while preserving gene–gene interactions better than MAGIC. Empirical support includes imputation-performance tests over parameter grids, where sc-PHENIX outperforms MAGIC in maintaining cluster structure and continuum organization (as shown in the referenced figures), and mean-squared correlation analyses on artificially corrupted bulk data showing that adding UMAP components improves imputation (Figure 2); 1–3 UMAP components yield the best (lowest) R2, and sc-PHENIX with PCA-UMAP is more robust to high PCA dimensionality than MAGIC (e.g., with n_pca = 71, MAGIC distorts topology whereas PCA-UMAP initialization improves sc-PHENIX). Pure UMAP initialization can underperform (PMBC data) due to over-smoothing of gene–gene interactions, whereas PCA-UMAP initialization preserves them; caution is advised with the 70% variability rule, as using only PCA without this initialization can distort topology in some datasets. The authors argue against universal preservation of Euclidean distances in high-dimensional space (as claimed by Chari et al.), showing that multidimensional PCA can fail to separate distinct phenotypic densities, whereas sc-PHENIX’s manifold-aware separation yields more accurate imputation and richer biological signals. They acknowledge limitations inherited from UMAP (risk of distorted local structure with many cells) and propose remedies such as re-clustering on subsets, while noting that subset-imputation cannot be readily compared across the full dataset; future work may involve alternative manifold-learning methods. Finally, sc-PHENIX already supports various UMAP variants (including supervised UMAP for microbiome data and integration with CITE-seq), with details in the Supplementary Material. Overall, sc-PHENIX offers improved data-structure preservation and denoising over MAGIC, enabling the discovery of new and more nuanced biological insights in both biological and non-biological systems.

섹션 etc: Supplementary Materials:
----------------------------------------
In this supplementary results section the authors use GSEA on the EMD scores of each dense cluster to compare non-imputed data with imputed results from MAGIC and sc-PHENIX on the MCF7 MCTS dataset. Non-imputed data yield 21 HALLMARK pathways, MAGIC yields 41, and sc-PHENIX yields 45, with imputation uncovering more than 20 new HALLMARK pathways overall. Four HALLMARKs appear only with imputation: XENOBIOTIC_METABOLISM (clusters 6 and 10), WNT_BETA_CATENIN_SIGNALING (cluster 5), APICAL_JUNCITON (clusters 3 and 6), and COAGULATION (clusters 1 and 3). Based on these HALLMARKs, the authors delineate invasive, proliferative, transition, and necrotic phenotypes: invasive and proliferative markers are linked to specific cluster patterns under MAGIC (proliferative in clusters 0–3; invasive in cluster 4), with over-smoothing masking transitions and microenvironmental context such as hypoxia and nutrient deprivation. In contrast, sc-PHENIX reveals a broader repertoire of extreme phenotypes; in particular, necrotic-like states emerge in clusters 0–3 where MT genes and VEGFA are over-smoothed, with cluster 3 least represented for necrosis and a transition observed from cluster 10 toward cluster 4 accompanied by several inflammatory Hallmark pathways. APOPTOSIS Hallmark pathways appear in clusters 3 and 5. The authors also note that visualization of phenotype markers on UMAP and the CCR7–IL7R interaction in PBMC data corroborate these observations. They further present Section S10, an interactive dashboard of HDBSCAN clusters across t-SNE, UMAP, PHATE, and 3D PCA embeddings, with imputed expression of VEGFA, ANLN, HIF1A, and NACA illustrating extreme phenotypes in sc-PHENIX-imputed data and discussing the biological significance of these genes in the extreme states. The supplement also outlines other applications (Section S11) and an extensive set of supporting materials, including MNIST analyses, and a detailed catalog of supplementary tables and sections (S1–S8), all accessible via the provided MDPI link; the authors reiterate that there are no conflicts of interest.

섹션 etc: GSEA Analysis of Cell Phenotype
----------------------------------------
The current section applies GSEA to the EMD score of each dense cluster for MAGIC and sc-PHENIX on the MCF7 MCTS to link imputed gene expression patterns with biological pathways. Non-imputed data yield 21 HALLMARK pathways, MAGIC yields 41, and sc-PHENIX yields 45, with imputation uncovering more than 20 new HALLMARKs (Supplementary Materials: Table S1). Four HALLMARKs appear only with sc-PHENIX: XENOBIOTIC_METABOLISM (clusters 6 and 10), WNT_BETA_CATENIN_SIGNALING (cluster 5), APICAL_JUNCITON (clusters 3 and 6), and COAGULATION (clusters 1 and 3), as shown in Figure 10B and Tables S1–S2. Based on these HALLMARKs, the authors delineate invasive, proliferative, transition, and necrotic phenotypes, with invasive-related HALLMARKs including REACTIVE_OXYGEN_SPECIES_PATHWAY, INTERFERON_ALPHA_RESPONSE, INTERFERON_GAMMA_RESPONSE, INFLAMMATORY_RESPONSE, APOPTOSIS, and HYPOXIA, and proliferative HALLMARKS such as E2F_TARGETS, G2M_CHECKPOINT, MITOTIC_SPINDLE, GLYCOLYSIS, and OXIDATIVE_PHOSPHORYLATION; transition shows a mix, while necrosis is characterized by comparatively few HALLMARKs. MAGIC associates the proliferative phenotype with clusters 0–3 and the invasive phenotype with cluster 4, but over-smoothing obscures transitions and microenvironmental context like hypoxia, with MT genes over-expressed in clusters 0–3 supporting proliferation and necrosis not clearly explained by the limited HALLMARKs. In contrast, sc-PHENIX reveals a broader repertoire of extreme phenotypes; necrotic-like states appear in clusters 0–3 where MT genes and VEGFA are over-smoothed, cluster 3 is the least represented for necrosis, and a transition from cluster 10 toward cluster 4 accompanies several inflammatory HALLMARK pathways, with APOPTOSIS HALLMARKs appearing in clusters 3 and 5. These phenotype patterns are also supported by UMAP visualization of phenotype markers (Figure 8C) and the CCR7–IL7R interaction in PBMC data discussed in Section S1. Section S10 provides an interactive dashboard of HDBSCAN clusters across t-SNE, UMAP, PHATE, and 3D PCA embeddings, visualizing imputed VEGFA, ANLN, HIF1A, and NACA—genes representative of extreme sc-PHENIX clusters (as shown in the EMD heatmap for Figure 10)—with the same HDBSCAN clustering as Figure 10 for MAGIC and sc-PHENIX; in the MCF7 cell lines and tumor spheroids, VEGFA, ANLN, HIF1A, and NACA occupy distinct extreme phenotypes in the sc-PHENIX imputed data, underscoring their roles in angiogenesis, cytokinesis, hypoxic adaptation, and stress response. The section also notes supplementary materials including Table S1 (Unique HALLMARKS), Table S2 (GSEA results by HALLMARKS), other sections (S1–S8), MNIST analyses, and the MDPI link; and the authors report no conflicts of interest.

섹션 etc: Conflicts of Interest:
----------------------------------------
In this section, the authors used Gene Set Enrichment Analysis (GSEA) to link imputed gene expression patterns, derived from dense clusters in MAGIC and sc-PHENIX on the MCF7 multicellular tumor spheroids (MCTS), to biological pathways. They applied GSEA to the EMD score of each dense cluster, comparing non-imputed data (21 HALLMARK pathways) with imputed data (MAGIC: 41 HALLMARKS; sc-PHENIX: 45 HALLMARKS), finding more than 20 new HALLMARKS unveiled by imputation (Supplementary Table S1). MAGIC’s over-smoothing did not yield more HALLMARKS than sc-PHENIX, indicating that sc-PHENIX’s sharing of gene information among truly similar cells reveals more HALLMARKS without excessive smoothing; four new HALLMARKS appear only with sc-PHENIX: XENOBIOTIC_METABOLISM (clusters 6 and 10), WNT_BETA_CATENIN_SIGNALING (cluster 5), APICAL_JUNCITON (cluster 3 and 6), and COAGULATION (clusters 1 and 3), as shown in Figure 10B and Tables S1–S2 and not present in non-imputed or MAGIC analyses. Building on these HALLMARKs, the authors categorize phenotypes into invasive, proliferative, transition, and necrotic states, with invasive-related HALLMARKs including REACTIVE_OXYGEN_SPECIES_PATHWAY, INTERFERON_ALPHA_RESPONSE, INTERFERON_GAMMA_RESPONSE, INFLAMMATORY_RESPONSE, APOPTOSIS, and HYPOXIA, and proliferative HALLMARKS such as E2F_TARGETS, G2M_CHECKPOINT, MITOTIC_SPINDLE, GLYCOLYSIS, and OXIDATIVE_PHOSPHORYLATION; transition shows a mix, while necrosis is characterized by comparatively few HALLMARKs. MAGIC associates the proliferative phenotype with clusters 0–3 and the invasive phenotype with cluster 4, but over-smoothing obscures transitions and microenvironmental context like hypoxia, with MT genes over-expressed in clusters 0–3 supporting proliferation and necrosis not clearly explained by the limited HALLMARKs. In contrast, sc-PHENIX reveals a broader repertoire of extreme phenotypes; necrotic-like states appear in clusters 0–3 where MT genes and VEGFA are over-smoothed, cluster 3 is the least represented for necrosis, and a transition from cluster 10 toward cluster 4 accompanies several inflammatory HALLMARK pathways, with APOPTOSIS HALLMARKs present in clusters 3 and 5. These patterns align with UMAP visualizations of phenotype markers (Figure 8C) and CCR7–IL7R interactions in PBMC data discussed in Section S1. Section S10 provides an interactive dashboard of HDBSCAN clusters across t-SNE, UMAP, PHATE, and 3D PCA embeddings, visualizing imputed VEGFA, ANLN, HIF1A, and NACA—genes representative of extreme sc-PHENIX clusters (as shown in the EMD heatmap for Figure 10)—using the same HDBSCAN clustering as Figure 10 for MAGIC and sc-PHENIX; in MCF7 cell lines and tumor spheroids, VEGFA, ANLN, HIF1A, and NACA occupy distinct extreme phenotypes in sc-PHENIX imputed data, underscoring their roles in angiogenesis, cytokinesis, hypoxic adaptation, and stress response. The section also references supplementary materials, including Table S1 (Unique HALLMARKS), Table S2 (GSEA results by HALLMARKS), and Sections S1–S8, MNIST analyses, and the MDPI link, with no conflicts of interest reported.

============================================================
총 섹션 수: 30
생성 시간: 2025-08-19 08:48:53
