sc-PHENIX builds the affinity matrix with an adaptive Gaussian kernel, following MAGIC's approach for imputation stability. The kernel bandwidth Ïƒ(i) for cell i is defined as the distance to its k-th nearest neighbor (knn), allowing the measure to adapt to local cell density. Applying this adaptive kernel to the distance matrix D_Dist yields a non-symmetric affinity matrix A_non-sim, where A_non-sim(i, j) need not equal A_non-sim(j, i). A symmetric affinity matrix A_sim is then obtained as required by Equation (3).